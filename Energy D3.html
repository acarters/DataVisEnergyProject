<!DOCTYPE html>
<meta charset="utf-8">
<!-- load d3.js -->
<style>
    /* Apply styles to the <p> element */
    p {
        font-family: Arial, sans-serif; /* Set the font family */
        font-size: 16px; /* Set the font size */
        line-height: 1.5; /* Set line height for better readability */
        color: #333; /* Set text color */
        margin: 0; /* Remove default margins */
        padding: 10px; /* Add padding for spacing */
    }
</style>
<script src="https://d3js.org/d3.v6.js"></script>

<div id="chart"></div>

<script>
const margin = {top: 50, right: 50, bottom: 50, left: 50}, width = 1000 - margin.left - margin.right, height = 400 - margin.top - margin.bottom; // Define the margins for the first chart.
const svg = d3.select("#chart") // Select the first chart.
.append("svg") // Append an svg element to the first chart div.
.attr("width", width + margin.left + margin.right) // Define the width of the chart using the margins and the defined width.
.attr("height", height + margin.top + margin.bottom) // Define the height of the chart using the margins and the defined height.
.append("g") // Append a g element.
.attr("transform", `translate(${margin.left}, ${margin.top})`); // Place the chart into the margins.
d3.csv("energy.csv", function(d) //Load the data from the csv.
{
	return { // Define our data elements from the dataset. 
		year: d["Year"],
		state: d["State"],
		/*coalComm: d["Consumption.Commercial.Coal"],
		coalElec: d["Consumption.Electric Power.Coal"],
		coalInd: d["Consumption.Industrial.Coal"],
		coalRef: d["Consumption.Refinery.Coal"],
		coalRes: d["Consumption.Residential.Coal"],
		coalTrans: d["Consumption.Transportation.Coal"],
		*/
		coal: +d["Consumption.Commercial.Coal"] + +d["Consumption.Electric Power.Coal"] + +d["Consumption.Industrial.Coal"] + +d["Consumption.Refinery.Coal"] + +d["Consumption.Residential.Coal"] + +d["Consumption.Transportation.Coal"],
		distFuelOil: +d["Consumption.Commercial.Distillate Fuel Oil"] + +d["Consumption.Electric Power.Distillate Fuel Oil"] + +d["Consumption.Industrial.Distillate Fuel Oil"] + +d["Consumption.Refinery.Distillate Fuel Oil"] + +d["Consumption.Residential.Distillate Fuel Oil"] + +d["Consumption.Transportation.Distillate Fuel Oil"],
		geothermal: +d["Consumption.Commercial.Geothermal"] + +d["Consumption.Industrial.Geothermal"],
		hydropower: +d["Consumption.Commercial.Hydropower"] + +d["Consumption.Industrial.Hydropower"],
		kerosene: +d["Consumption.Commercial.Kerosene"] + +d["Consumption.Industrial.Kerosene"] + +d["Consumption.Residential.Kerosene"],
		petroleum: +d["Consumption.Commercial.Petroleum"] + +d["Consumption.Industrial.Petroleum"] + +d["Consumption.Residential.Petroleum"] + +d["Consumption.Transportation.Petroleum"],
		naturalGas: +d["Consumption.Commercial.Natural Gas"] + +d["Consumption.Electric Power.Natural Gas"] + +d["Consumption.Industrial.Natural Gas"] + +d["Consumption.Refinery.Natural Gas"] + +d["Consumption.Residential.Natural Gas"] + +d["Consumption.Transportation.Natural Gas"],
		solar: +d["Consumption.Commercial.Solar"] + +d["Consumption.Industrial.Solar"],
		wind: +d["Consumption.Commercial.Wind"] + +d["Consumption.Industrial.Wind"],
		wood: +d["Consumption.Commercial.Wood"] + +d["Consumption.Electric Power.Wood"] + +d["Consumption.Industrial.Wood"] + +d["Consumption.Residential.Wood"],
		otherPetrol: +d["Consumption.Industrial.Other Petroleum Products"]
	
	};
}).then( function(data) 
{		

	const thisState = "North Carolina"; // Currently hard-coded state value. Change this to get graphs for other states.
	const stateData = data.filter(d => d.state == thisState);
	
	const x = d3.scaleTime() // Create the x-axis by scaling by time values that will be initialized with the dates given.
	.domain([new Date(d3.min(data, d=> d.year)),new Date(d3.max(data, d=> d.year))]) // Creates new dates equal to the years given by the csv and use the min and max as the domain bounds.
	.range([0, width]); // Make the graph as large as the defined width. 
	
	const y = d3.scaleLinear() // Create the y-axis by scaling linear.
	.domain([d3.max(stateData, d=> d.coal + d.distFuelOil + d.kerosene + d.petroleum + d.naturalGas + d.otherPetrol), 0]) // Create the domain bounds based on the rounds.
	.range([0, height]); // Make the graph as large as the defined height.
	
	svg.append("g")
	.attr("transform", `translate(0, ${height})`)
	.call(d3.axisBottom(x));
		
	svg.append("g")
	.call(d3.axisLeft(y));
	
	svg.append("g") // Append the g element for the presidents' trophy dots.
	.selectAll("dot") // Select the dots.
	.data(stateData) // Use our csv data as the data.
	.join("circle") // Add circles. These will be our dots.
	.attr("r", 5)
	.attr("cx", function (d) 
	{
		return x(new Date(d.year)); // Set the x value of the dot to be equal to the amount of points on the x axis.
	}) 
	.attr("cy", function (d) 
	{	
		return y(d.geothermal + d.hydropower + d.solar + d.wind + d.wood); // Renewable fuel sources
	}) 
	.attr("fill", "blue");
	
	svg.append("g") // Append the g element for the presidents' trophy dots.
	.selectAll("dot") // Select the dots.
	.data(stateData) // Use our csv data as the data.
	.join("circle") // Add circles. These will be our dots.
	.attr("r", 5)
	.attr("cx", function (d) 
	{
		return x(new Date(d.year)); // Set the x value of the dot to be equal to the amount of points on the x axis.
	}) 
	.attr("cy", function (d) 
	{
		/* 
		Coal Test Cases
		if (d.year == 1971 && d.state == "North Carolina")
		{
			console.log("coalComm: " + d.coalComm);
			console.log("coalElec: " + d.coalElec);
			console.log("coalInd: " + d.coalInd);
			console.log("coalRef: " + d.coalRef);
			console.log("coalRes: " + d.coalRes);
			console.log("coalTrans: " + d.coalTrans);
			console.log("coal: " + d.coal);
		}
		*/
		
		return y(d.coal + d.distFuelOil + d.kerosene + d.petroleum + d.naturalGas + d.otherPetrol); // Non-Renewable fuel sources
	}) 
	.attr("fill", "red");
})
</script>
